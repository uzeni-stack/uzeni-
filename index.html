<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UD√çRNA - Objedn√°vka</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 10px; margin: 0; }
        .container { max-width: 600px; margin: auto; }
        
        /* ƒåist√Ω nadpis bez niƒçeho jin√©ho */
        h1 { text-align: center; color: #1976d2; font-size: 3em; margin: 40px 0 20px 0; letter-spacing: 5px; text-transform: uppercase; font-weight: 900; }

        .zbozi-sekce { background: white; margin-bottom: 20px; border-radius: 12px; border: 1px solid #1976d2; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .zbozi-hlavicka { background: #1976d2; color: white; padding: 12px 15px; font-weight: bold; display: flex; justify-content: space-between; }
        
        table { width: 100%; border-collapse: collapse; background: white; }
        td { padding: 15px; border-bottom: 1px solid #eee; }
        
        .kosik-box { background: #e8f5e9; border: 2px solid #2e7d32; border-radius: 15px; padding: 20px; margin-top: 25px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .input-text { width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #1976d2; border-radius: 8px; box-sizing: border-box; font-size: 1.1em; }
        .input-vaha { width: 75px; padding: 8px; border: 1px solid #2e7d32; border-radius: 5px; text-align: center; font-weight: bold; font-size: 1em; }
        
        .btn-add { background: #1976d2; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-send { background: #2e7d32; color: white; border: none; padding: 20px; border-radius: 10px; cursor: pointer; font-weight: bold; width: 100%; font-size: 1.3em; margin-top: 15px; text-transform: uppercase; }
        .btn-del { color: #d32f2f; background: none; border: none; cursor: pointer; font-size: 1.2em; margin-left: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>UD√çRNA</h1>

    <div class="zbozi-sekce">
        <div class="zbozi-hlavicka"><span>üì¶ NAB√çDKA</span><span>Kƒç/kg</span></div>
        <table id="tabulka-nabidky">
            <tr><td style="text-align:center; padding:20px;">Naƒç√≠t√°m nab√≠dku...</td></tr>
        </table>
    </div>

    <div class="kosik-box">
        <h3 style="margin:0 0 10px 0; color:#2e7d32; text-align: center;">üõí V√Å≈† KO≈†√çK</h3>
        <div id="obsah-kosiku" style="text-align: center; color: #666;">Vyberte si uzeniny v√Ω≈°e</div>
        
        <div id="form-odeslat" style="display:none; margin-top:20px; border-top: 2px dashed #2e7d32; padding-top:20px;">
            <input type="text" id="zakaznik-jmeno" class="input-text" placeholder="Va≈°e jm√©no">
            <button class="btn-send" onclick="odeslat()">POTVRDIT OBJEDN√ÅVKU</button>
        </div>
    </div>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://eshop-fh-default-rtdb.europe-west1.firebasedatabase.app" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let kosik = {};

    db.ref("produkty").on("value", (snap) => {
        const produkty = snap.val() || {};
        const tabulka = document.getElementById("tabulka-nabidky");
        tabulka.innerHTML = "";
        for (let n in produkty) {
            tabulka.innerHTML += `
                <tr>
                    <td><b>${n}</b></td>
                    <td>${produkty[n]} Kƒç</td>
                    <td style="text-align:right;"><button class="btn-add" onclick="doKosiku('${n}')">P≈òIDAT</button></td>
                </tr>`;
        }
    });

    function doKosiku(n) { 
        if (!kosik[n]) kosik[n] = 1.0; 
        vykresli(); 
    }
    
    function zmenVahu(n, v) { 
        let nv = parseFloat(v); 
        if (nv <= 0 || isNaN(nv)) delete kosik[n]; else kosik[n] = nv; 
        vykresli(); 
    }

    function smazat(n) { 
        delete kosik[n]; 
        vykresli(); 
    }

    function vykresli() {
        const div = document.getElementById("obsah-kosiku");
        const form = document.getElementById("form-odeslat");
        const pol = Object.keys(kosik);
        
        if (pol.length === 0) { 
            div.innerHTML = "Vyberte si uzeniny v√Ω≈°e"; 
            form.style.display = "none"; 
            return; 
        }
        
        form.style.display = "block";
        let h = "<table style='width:100%;'>";
        pol.forEach(n => {
            h += `<tr><td><b>${n}</b></td><td style="text-align:right;"><input type="number" step="0.1" class="input-vaha" value="${kosik[n]}" oninput="zmenVahu('${n}', this.value)"> kg <button class="btn-del" onclick="smazat('${n}')">üóëÔ∏è</button></td></tr>`;
        });
        div.innerHTML = h + "</table>";
    }

    function odeslat() {
        const jm = document.getElementById("zakaznik-jmeno").value;
        if (!jm) { alert("Napi≈°te jm√©no!"); return; }
        Object.keys(kosik).forEach(n => {
            db.ref("objednavky").push({ 
                zakaznik: jm, produkty: n, vaha: kosik[n], 
                skutecna_vaha_gr: 0, skutecna_cena: 0, zaplaceno: 0 
            });
        });
        alert("Odesl√°no!"); kosik = {}; document.getElementById("zakaznik-jmeno").value = ""; vykresli();
    }
</script>
</body>
</html>
